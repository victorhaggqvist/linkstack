"use strict";!function(){var t=(document.querySelector("#pushform"),document.querySelector("#form_url")),e=document.querySelector("#form_title"),n=document.querySelector("#form_tags"),o=document.querySelector("#form_save"),l=document.querySelector("#recentlist tbody"),u=document.querySelector("#status"),r=document.querySelector("#statusMsg"),s="https://tool.stack.snilius.com",a=!1,c=function(){if(!a&&!(t.value.length<5)&&(e.value.length<1||n.value.length<1)){a=!0;var o=s+"/info?url="+t.value;fetch(o).then(function(t){return t.json()},function(t){return console.error("meta fetch fail: "+t)}).then(function(o){void 0!==o&&(a=!1,e.value.length<1&&(e.value=o.title),n.value.length<1&&(n.value=o.meta),t.value!==o.longurl&&(t.value=o.longurl))})}},i=function(){console.log(this);var t=this,e=this.getAttribute("data-id");t.className+=" spinner",fetch("/api/items/"+e,{method:"delete",credentials:"include"}).then(function(e){204===e.status&&t.parentNode.parentNode.remove(),console.log(e)})["catch"](function(t){return console.error(t)})},d=function(t,e,n,o){var u=new Date,r=u.getFullYear(),s=u.getMonth()+1<10?"0"+(u.getMonth()+1):u.getMonth()+1,a=u.getDate()<10?"0"+u.getDate():u.getDate(),c=u.getHours()<10?"0"+u.getHours():u.getHours(),d=u.getMinutes()<10?"0"+u.getMinutes():u.getMinutes(),h=r+"-"+s+"-"+a+" "+c+":"+d,g=n.length>25?'title="'+n.substr(0,25)+'"':"",f=n.length>25?n.substr(0,25)+"...":n,m=e.length>50?'title="'+e.substr(0,50)+'"':"",v=e.length>50?e.substr(0,50)+"...":e,b=document.createElement("tr");b.innerHTML='<td><img src="https://www.google.com/s2/favicons?domain='+t+'" alt="fav"><a class="title" href="'+t+'">'+t+"</a></td><td"+m+">"+v+"</td><td"+g+">"+f+"</td><td>"+h+'</td><td class="action"><button type="button" class="btn btn-default btn-sm delete-btn icon-button" data-id="'+o+'"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button></td>',l.insertBefore(b,l.firstChild);var y=document.querySelector('button[data-id="'+o+'"]');y.onclick=i};o.onclick=function(l){l.preventDefault();var s={title:e.value,url:t.value,tags:n.value};o.innerHTML="Pushing...",o.disabled="disabled",fetch("/api/items",{method:"post",body:JSON.stringify(s),credentials:"include"}).then(function(t){return t.json()}).then(function(l){"message"in l?(r.innerHTML=l.message,u.style.display="block",o.disabled=null,o.innerHTML="Push"):(console.log(l),d(s.url,s.title,s.tags,l.id),t.value="",e.value="",n.value="",o.disabled=null,o.innerHTML="Push")})["catch"](function(t){return console.error(t)})},console.info("set hooks"),t.onkeyup=c,t.onmouseout=c,t.onchange=c;var h=document.querySelectorAll(".delete-btn");Array.prototype.forEach.call(h,function(t){t.onclick=i}),console.info("linkstack boot")}();